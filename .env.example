# ===========================================
# Contrarian AI Trading Platform
# Environment Configuration Template
# ===========================================

# Database
# For local development with docker-compose
DATABASE_URL="postgresql://contrarian:contrarian_dev@localhost:5432/contrarian_ai"

# Kraken API (Story 1.3 & 3.1)
# Get your keys from: https://www.kraken.com/u/security/api
# IMPORTANT: API keys should have ONLY "Query Funds" + "Create & Modify Orders" permissions
# NEVER enable "Withdraw Funds" permission for security
KRAKEN_API_KEY="your-api-key-here"
KRAKEN_API_SECRET="your-api-secret-here"
# Private key for Kraken API (same as API_SECRET for most operations)
KRAKEN_PRIVATE_KEY="your-private-key-here"
# Sandbox mode: Set to "true" for testing (logs orders but doesn't execute)
# Set to "false" for live trading (CAUTION: real money!)
KRAKEN_SANDBOX_MODE="true"

# LunarCrush API (Story 1.4)
# Get your key from: https://lunarcrush.com/developers
LUNARCRUSH_API_KEY=""

# Telegram API (Story 1.4 - Sentiment Scraping)
# Get your credentials from: https://my.telegram.org/apps
# 1. Log in with your phone number
# 2. Create a new application
# 3. Copy the api_id and api_hash
# After setting these, run: python -m services.socials.telegram_auth
TELEGRAM_API_ID=""
TELEGRAM_API_HASH=""
TELEGRAM_PHONE=""  # With country code, e.g., +1234567890
# Optional: Custom channel list (comma-separated, without @)
# TELEGRAM_CHANNELS="CoinDesk,Cointelegraph,bitcoinmagazine"

# CryptoPanic API (Story 1.4 - News Sentiment)
# Get your API key from: https://cryptopanic.com/developers/api/
# Uses Developer v2 API: https://cryptopanic.com/api/developer/v2/posts/
# CryptoPanic aggregates crypto news and provides community sentiment votes
CRYPTOPANIC_API_KEY="your-auth-token-here"

# Google Gemini AI for Sentiment Analysis (Story 2.2)
# Get your key from: https://aistudio.google.com/app/apikey
GOOGLE_AI_API_KEY=""
GEMINI_MODEL="gemini-2.0-flash-lite"
GEMINI_TEMPERATURE="0.3"
GEMINI_MAX_TOKENS="1024"

# Next.js
NEXT_PUBLIC_APP_URL="http://localhost:3000"

# Bot Service
BOT_PORT=8000
WEB_URL="http://localhost:3000"

# Risk Management (Story 3.2 - Dynamic Risk Engine)
# ATR-based stop loss calculation parameters
RISK_ATR_PERIOD="14"
RISK_ATR_MULTIPLIER="2.0"
RISK_MAX_STOP_LOSS_PERCENTAGE="0.20"
RISK_MIN_STOP_LOSS_PERCENTAGE="0.02"
RISK_DEFAULT_PER_TRADE="0.02"

# Story 5.3: Multi-Factor Confirmation System
# Minimum factors required for BUY signal (default: 3 of 6)
MIN_FACTORS_BUY="3"
# Minimum factors required for SELL signal (default: 2 of 5)
MIN_FACTORS_SELL="2"
# Fear & Greed thresholds for extreme conditions
EXTREME_FEAR_THRESHOLD="25"
EXTREME_GREED_THRESHOLD="75"
# RSI thresholds for oversold/overbought conditions
RSI_OVERSOLD_THRESHOLD="30"
RSI_OVERBOUGHT_THRESHOLD="70"
# Support/Resistance proximity (percentage from SMA200)
SUPPORT_PROXIMITY_PCT="3.0"
RESISTANCE_PROXIMITY_PCT="3.0"
# Volume thresholds (multiplier of average)
VOLUME_CAPITULATION_MULT="2.0"
VOLUME_EXHAUSTION_MULT="0.5"

# Debug mode (set to "true" for verbose logging)
DEBUG="false"

# Story 5.4: Position Scaling Configuration
# Scale-in: Build position gradually to achieve better average prices
# Scale-out: Exit position gradually to lock in profits

# Number of scale levels (default: 3 for both entry and exit)
NUM_SCALE_IN_LEVELS=3
NUM_SCALE_OUT_LEVELS=3

# Scale-in allocation percentages (must sum to 100)
SCALE_IN_PCT_1=33.33
SCALE_IN_PCT_2=33.33
SCALE_IN_PCT_3=33.34

# Scale-in trigger levels (% below first entry price)
SCALE_IN_DROP_2=5.0   # 5% drop triggers scale 2
SCALE_IN_DROP_3=10.0  # 10% drop triggers scale 3 (capitulation)

# Scale-out allocation percentages (must sum to 100)
SCALE_OUT_PCT_1=33.33
SCALE_OUT_PCT_2=33.33
SCALE_OUT_PCT_3=33.34

# Scale-out profit targets (% above average entry)
SCALE_OUT_PROFIT_1=10.0  # 10% profit = first exit
SCALE_OUT_PROFIT_2=20.0  # 20% profit = second exit
# Scale 3 uses trailing stop from position manager

# Timeout for pending scale orders (hours) - orders expire after this
SCALE_TIMEOUT_HOURS=168  # 7 days default
